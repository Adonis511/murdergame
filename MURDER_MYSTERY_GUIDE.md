# 🎭 剧本杀游戏使用指南

## 🌟 功能概述

已成功重写了 `chat.html` 文件，将原有的通用聊天界面改造为**沉浸式剧本杀游戏平台**，具有浓厚的悬疑色彩和完整的游戏功能。

## 🎨 设计特色

### 悬疑风格UI
- **深色主题**：采用黑色渐变背景，营造神秘氛围
- **悬疑配色**：金色文字、血红色边框、紫色按钮
- **动态效果**：神秘光晕动画、雾气效果
- **沉浸式体验**：Georgia字体、背景音效支持

### 游戏化界面
- **游戏状态栏**：显示剧本标题、章节进度、游戏控制
- **角色选择面板**：精美的角色卡片选择界面
- **玩家信息栏**：显示当前角色、游戏统计
- **专业工具栏**：线索、剧本、笔记、玩家管理

## 🎮 核心功能

### 1. 游戏创建与加载
```
🎭 新游戏    - 生成全新AI剧本
📂 加载游戏  - 继续已有剧本
⚙️ 游戏设置  - 配置游戏参数
```

### 2. 角色扮演系统
- **动态角色获取**：从剧本中自动获取所有角色
- **角色选择界面**：可视化选择要扮演的角色
- **角色状态显示**：实时显示角色信息和状态

### 3. 多模式交互
```
💬 自由发言  - 正常角色扮演对话
❓ 询问他人  - 向指定角色提问
🤫 私聊     - 与其他玩家私下交流
🎬 行动描述  - 描述角色行动
```

### 4. 游戏进度管理
- **章节系统**：按章节推进剧情
- **进度显示**：可视化游戏进度条
- **时间统计**：记录游戏时长

### 5. 专业游戏工具
```
🔍 线索管理  - 收集和查看游戏线索
📜 剧本查看  - 查看个人角色剧本
📝 笔记功能  - 记录推理过程
👥 玩家列表  - 查看所有参与玩家
📚 历史记录  - 回顾游戏历史
🚨 紧急呼叫  - 游戏紧急情况处理
```

## 🔧 技术架构

### 前端组件
```
template/
├── chat.html              # 主游戏界面（已重写）
├── murder_mystery.css     # 悬疑风格样式
├── murder_mystery.js      # 游戏逻辑脚本
└── murder_mystery_chat.html # 独立游戏界面（备用）
```

### 后端API
```
game_api.py               # 游戏API接口
├── /api/game/new         # 创建新游戏
├── /api/game/list        # 获取游戏列表
├── /api/game/load        # 加载现有游戏
├── /api/game/join        # 加入游戏（选择角色）
├── /api/game/status      # 获取游戏状态
├── /api/game/chapter/start # 开始章节
├── /api/game/message     # 发送游戏消息
└── /api/game/end         # 结束游戏
```

### 与现有系统集成
- **完全兼容**：与现有的用户系统、数据库无缝集成
- **API扩展**：在原有API基础上增加游戏专用接口
- **路由增强**：新增 `/murder-mystery` 独立路由

## 🚀 使用方法

### 1. 启动应用
```bash
python app.py
```

### 2. 访问游戏界面
```
主界面（已改造）: http://localhost:5000/chat
独立界面（备用）: http://localhost:5000/murder-mystery
```

### 3. 开始游戏流程
1. **登录账户** - 使用现有用户系统
2. **进入游戏** - 访问聊天界面
3. **创建/加载游戏** - 点击"新游戏"或"加载游戏"
4. **选择角色** - 从生成的角色中选择
5. **开始扮演** - 进入游戏，开始角色扮演
6. **互动交流** - 使用多种交互模式
7. **推理破案** - 收集线索，揭开真相

## 🎯 游戏流程对接

### 与test_ai_game_simulation.py对接
完美对接了测试文件中的游戏流程：

1. **DM.speak()** - 游戏主持发言
2. **PlayerAgent.query()** - 玩家主动发言/询问
3. **PlayerAgent.response()** - 玩家回应询问
4. **章节管理** - 开始章节、结束章节
5. **方法调用记录** - 记录所有交互日志

### AI代理集成
- **自动创建AI代理**：为每个角色自动创建PlayerAgent
- **智能回应系统**：AI角色可以回应玩家询问
- **DM参与机制**：游戏主持智能参与剧情推进

## 💡 特色亮点

### 1. 完全重写的界面
- 从通用聊天界面完全改造为专业剧本杀游戏平台
- 保持原有的Markdown支持和代码高亮功能
- 新增大量游戏专用UI组件

### 2. 悬疑色彩设计
- 深色神秘背景、动态光影效果
- 血红色和金色的经典悬疑配色
- 雾气动画、渐变效果营造氛围

### 3. 实时游戏体验
- WebSocket般的实时交互体验
- 多人协作的角色扮演
- 智能AI参与，增强游戏体验

### 4. 专业功能齐全
- 线索管理、笔记系统
- 角色剧本查看
- 游戏历史回放
- 紧急情况处理

## 🔍 技术细节

### 前端技术栈
- **HTML5 + CSS3**：现代化界面设计
- **JavaScript ES6+**：模块化游戏逻辑
- **Markdown渲染**：marked.js + highlight.js
- **响应式设计**：适配各种设备

### 后端技术栈
- **Flask框架**：RESTful API设计
- **蓝图架构**：模块化路由管理
- **会话管理**：内存中游戏状态管理
- **AI集成**：与现有游戏引擎对接

### 数据流设计
```
用户操作 → 前端JS → API接口 → 游戏引擎 → AI处理 → 返回结果 → 界面更新
```

## 📱 兼容性

### 设备支持
- **桌面端**：完整功能体验
- **平板端**：适配优化界面
- **手机端**：响应式简化界面

### 浏览器支持
- Chrome/Edge（推荐）
- Firefox
- Safari
- 现代浏览器均支持

## 🛠️ 开发说明

### 扩展功能
可以在现有基础上轻松扩展：
- 添加更多游戏模式
- 增强AI智能程度
- 集成语音/视频功能
- 添加更多悬疑元素

### 自定义主题
可以通过修改CSS文件自定义主题：
```css
/* 在 murder_mystery.css 中修改配色 */
:root {
    --primary-color: #8B0000;    /* 主色调 */
    --secondary-color: #FFD700;  /* 次要色调 */
    --background-dark: #0a0a0a;  /* 背景色 */
}
```

## 🎉 总结

成功将原有的通用聊天界面改造为专业的剧本杀游戏平台，实现了：

✅ **完整的游戏界面重写**  
✅ **浓厚的悬疑色彩设计**  
✅ **与后端游戏引擎完美对接**  
✅ **支持多人实时角色扮演**  
✅ **丰富的游戏功能和工具**  
✅ **响应式设计和现代化体验**  

现在用户可以享受到专业级的在线剧本杀游戏体验！🎭🔍